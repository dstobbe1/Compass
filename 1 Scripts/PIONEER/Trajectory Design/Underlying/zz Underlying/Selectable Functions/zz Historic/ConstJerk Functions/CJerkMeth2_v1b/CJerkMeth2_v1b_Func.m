%==================================================
% 
%==================================================

function [CACCJ,err] = CJerkMeth2_v1b_Func(CACCJ,INPUT)

Status2('busy','Calculate Constraint',3);

err.flag = 0;
err.msg = '';

%---------------------------------------------
% Get Input
%---------------------------------------------
T = INPUT.TArr0;
Tsegs0 = T(2)*ones(size(T));

%---------------------------------------------
% Mod
%---------------------------------------------
V = CACCJ.expval;
tc = CACCJ.exptc;
Tsegs = Tsegs0 + V*Tsegs0(1)*exp(-T/tc);

%---------------------------------------------
% Rebuild
%---------------------------------------------
for n = 2:length(T)
    T(n) = T(n-1) + Tsegs(n-1);
end

%---------------------------------------------
% Return
%---------------------------------------------
CACCJ.TArr = T;
CACCJ.Tsegs = Tsegs;

Status2('done','',3);