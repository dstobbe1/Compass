%=====================================================
% 
%=====================================================

function [GFIX,err] = GFix_Smooth_v1a_Func(GFIX,INPUT)

Status2('busy','Gradient Fix',3);

err.flag = 0;
err.msg = '';

%---------------------------------------------
% Get Input
%---------------------------------------------
G0 = INPUT.G0;
clear INPUT
nproj = length(G0(:,1,1));

%---------------------------------------------
% Smooth
%---------------------------------------------
G = zeros(size(G0));
for n = 1:nproj
    for d = 1:3
        G(n,:,d) = smooth(G0(n,:,d),GFIX.smoothwin);
    end
end
   
%---------------------------------------------
% Return
%---------------------------------------------
GFIX.G0fix = G;

Status2('done','',3);
