%=========================================================
% 
%=========================================================

function E = AlignImages_v1b_Reg(V,ALGN,INPUT)

%---------------------------------------------
% Get Input
%---------------------------------------------
Im1 = INPUT.Image(:,:,:,1);
Im2 = INPUT.Image(:,:,:,2);
clear INPUT

%---------------------------------------------
% Scale 'V's
%---------------------------------------------
V(1:3) = V(1:3)/10;
V(4:6) = V(4:6)*10;

%---------------------------------------------
% Transform Image
%---------------------------------------------
tIm2 = Transform3DMatrix_v1c(Im2,V(1),V(2),V(3),V(4),V(5),V(6));

%-----------------------------------------
% Error Vector
%-----------------------------------------
tIm2 = tIm2 * V(7);
E = tIm2(:) - Im1(:);
V

%====================================================
% Plot Image
%====================================================
INPUT.Image = (tIm2 - Im1);
INPUT.MSTRCT.type = 'real';
INPUT.MSTRCT.dispwid = [-max(abs(INPUT.Image(:))) max(abs(INPUT.Image(:)))];
INPUT.MSTRCT.colour = 'Yes';
PlotMontage_v1c(INPUT);
  