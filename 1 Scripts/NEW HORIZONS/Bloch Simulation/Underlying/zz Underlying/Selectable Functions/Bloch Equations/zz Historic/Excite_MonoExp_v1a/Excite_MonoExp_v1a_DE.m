%=========================================================
% 
%=========================================================

function dM = Excite_MonoExp_v1a_DE(t,M,BLOCHEX,INPUT)

%---------------------------------------------
% Get Input
%---------------------------------------------
T1 = INPUT.T1;
T2 = INPUT.T2;
w1 = INPUT.w1*2*pi/1000;
woff = INPUT.woff*2*pi/1000;            % w1 & woff = rad/msec
clear INPUT

%-----------------------------------------
% Differential Equantions (as Haacke page 61)
%-----------------------------------------
M0 = 1;
dM = zeros(3,1);				

dM(1) = (-w1 * M(3)) + (M0 - M(1))/T1;                      % M(1) = z
dM(2) = (woff * M(3)) - M(2)/T2;                            % M(2) = x
dM(3) = (-woff * M(2)) + (w1 * M(1)) - M(3)/T2;             % M(3) = y

